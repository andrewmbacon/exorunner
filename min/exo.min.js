$(document).ready(function(){function e(e){console.log("audio playing now...");var t=$("<audio>");t.attr("id","audio-"+e);var n=$("<source>");n.attr("type","audio/aac"),n.attr("src","audio/"+e+".aac"),console.log("building audio tag..."),t.append(n),console.log("adding audio to body..."),$("body").append(t),console.log("playing audio...");var o=document.getElementById("audio-"+e);o.addEventListener("ended",function(){console.log("audio ended: "+this),$(o).remove()},!1),$("body").append(o),o.play()}function t(e){var t=document.getElementById("audio-"+e);t&&t.pause(),$(t).remove()}function n(){w="",T=0,b=0,k=0,D=0,z=0}function o(){clearInterval(tickerInterval),clearInterval(timeInterval),clearInterval(completionInterval)}function r(){e("mus-main"),$("#loading").fadeIn(2e3).fadeOut(1e3),setTimeout(function(){$("#run").fadeIn(500)},3e3),setTimeout(function(){s()},4500)}function s(){$("#race-day").hide(),M?($("#next-run").show(),$("#today-run").hide()):($("#next-run").hide(),$("#today-run").show())}function a(){}function u(){timeInterval=setInterval(function(){k++,console.log("timeElapsed..."+k),i()},1e3)}function l(e){var t=Math.floor(e/60),n=k%60;10>n&&(n="0"+n);var o=t+":"+n;return o}function i(){console.log("updating seconds..."),$("#time-elapsed").html(l(k));var e=k/I*100;100>e&&$("#time-progress-bar").attr("style","width:"+e+"%;"),k%15==0&&(D=parseFloat(D),D+=.1,D=D.toFixed(1),$("#distance").html(D+" mi")),k%10==0&&(z+=5,$("#calories").html(z+" cal"))}function c(){console.log("incrementing...");var e=$("#heartmeter").attr("class");console.log("currentClass..."+e);var t=e.substr(e.length-1),n=Number(t);n++;var o="zone"+n;$("#heartmeter").attr("class",o),console.log("currentClass..."+o),f()}function m(){console.log("decrementing...");var e=$("#heartmeter").attr("class");console.log("currentClass..."+e);var t=e.substr(e.length-1),n=Number(t);n--;var o="zone"+n;$("#heartmeter").attr("class",o),console.log("currentClass..."+o),f()}function f(){console.log("updating heart text...");var e=$("#heartmeter").attr("class");"zone1"==e?(w="88",T=0):"zone2"==e?(w="119",T=1):"zone3"==e?(w="120",T=2):"zone4"==e?(w="134",T=1):"zone5"==e&&(w="148",T=0),$("#bpm").html(w),$("#multiplier-num").html(T)}function d(){tickerInterval=setInterval(function(){console.log("tick...");var e=1*T;b+=e,$("#score").html(b)},125)}function p(){console.log("runStatus..."),n(),a(),u(),f(),d(),setTimeout(function(){c(),e("sfx-prompt")},3e3),setTimeout(function(){c(),$("#audio-sfx-prompt").remove(),e("sfx-prompt")},6e3),setTimeout(function(){c(),e("sfx-prompt-confirm")},9e3),setTimeout(function(){c(),$("#audio-sfx-prompt-confirm").remove(),e("sfx-prompt-confirm")},12e3),setTimeout(function(){m(),e("sfx-prompt")},15e3),setTimeout(function(){m(),$("#audio-sfx-prompt").remove(),e("sfx-prompt")},18e3),setTimeout(function(){e("sfx-powerup"),T=3,$("#multiplier-num").html(T),$("#multiplier").addClass("upgrade1")},23e3),setTimeout(function(){e("sfx-powerup"),T=4,$("#multiplier-num").html(T),$("#multiplier").addClass("upgrade2")},27e3),setTimeout(function(){T=6,e("sfx-powerup"),$("#multiplier-num").html(T),$("#multiplier").addClass("upgrade3")},31e3),completionInterval=setInterval(function(){k>=I&&(v("#run-results"),o(),animateRunScreen=!1,h(),t("mus-run"))},1e3)}function v(e){console.log("Going to screen..."+e),$(".screen").hide(),$(e).show()}function h(){function t(){$("#final-score").html(o),o==r?($("#star1").attr("class","star earned"),e("sfx-ding")):o==s?(console.log("star2..."),$("#star2").attr("class","star earned"),$("#audio-sfx-ding").remove(),e("sfx-ding")):o==a&&(console.log("star3..."),$("#star3").attr("class","star earned"),e("sfx-ding")),E>=S?$(".level-progress").css("width",100*(S/E)+"%"):$(".level-progress").css("width","100%")}function n(){setTimeout(function(){o+=100,S+=100,$("#bonus1").show(),e("sfx-bump"),t()},1e3),setTimeout(function(){o+=100,S+=100,$("#bonus2").show(),e("sfx-bump"),t()},2e3),setTimeout(function(){o+=350,S+=350,$("#bonus3").show(),e("sfx-bump"),t(),$("#star3").attr("class","star earned"),e("sfx-ding")},3e3),setTimeout(function(){$("#levelUp").modal(),e("sfx-levelup")},4500)}b=799,e("sfx-drumroll");var o=0,r=Math.floor(.33*C),s=Math.floor(.66*C),a=C;console.log(r),console.log(s),console.log(a),tallyScore=setInterval(function(){b>o?(o++,S++,t()):(clearInterval(tallyScore),n())},9)}function g(){$("#audio-mus-main").remove(),e("mus-run");var t=6,n=1;moveRunners=setInterval(function(){t>=n?(n++,$(".runner").attr("class","runner pos"+n)):clearInterval(moveRunners)},2e3),setTimeout(function(){$("#place").attr("class","second"),$("#place-num").html("2"),e("sfx-prompt-confirm")},3200),setTimeout(function(){$("#place").attr("class","first"),e("sfx-prompt"),$("#place-num").html("1")},4e3),setTimeout(function(){$("#place").attr("class","second"),$("#audio-sfx-prompt-confirm").remove(),e("sfx-prompt-confirm"),$("#place-num").html("2")},5800),setTimeout(function(){$("#place").attr("class","first"),e("sfx-prompt"),$("#place-num").html("1")},12e3),setTimeout(function(){$("#lap").attr("class","lap2"),$("#lap-num").html("2"),e("sfx-bump")},14e3),setTimeout(function(){v("#race-results"),x()},15e3)}function x(){function t(){var t=15,n=1;starDropper=setInterval(function(){if(t>=n){n++;var o=$("#reward-star").clone().css("display","inline");$("#reward").append(o),$("#audio-sfx-ding").remove(),e("sfx-ding")}else clearInterval(starDropper)},200)}$("#audio-mus-run").remove(),e("mus-victory"),t()}function y(){function t(){n>=0?($("#countdown-num").html(n).attr("class","step"+n),$("#audio-sfx-bump").remove(),e("sfx-bump"),n--):($("#audio-sfx-bump").remove(),clearInterval(counter))}var n=5;t(),counter=setInterval(function(){t()},1e3)}var I=40,w="",T=0,b=0,k=0,D=0,z=0,C=1e3,E=1500,S=200,M=!1;$("#collapseOne").collapse("hide"),r(),$(function(){$('[data-toggle="tooltip"]').tooltip()}),$("#start-run").on("click",function(n){n.preventDefault(),t("mus-main"),e("sfx-select"),v("#countdown-screen"),y("run-status"),setTimeout(function(){v("#run-status"),p(),e("mus-run")},6e3),$("#today-run").hide(),$("#tomorrow-run").show()}),$("#leave-run-results").on("click",function(){M=!0,v("#run"),e("sfx-select"),$("#audio-mus-run").remove(),e("mus-main"),$("#today-run").hide(),$("#next-run").show(),$("#race-day").hide()}),$(".footer-run").on("click",function(e){console.log("clicking footer-run..."),e.preventDefault(),v("#run")});var R=9;$("#days").on("click",function(e){e.preventDefault(),R--,R>=0&&$("#days-num").html(R),0==R&&($("#today-run").hide(),$("#next-run").hide(),$("#race-day").show())}),$("#start-race").on("click",function(e){e.preventDefault(),$("#audio-mus-main").remove(),v("#race-status"),g()}),$(".footer-the-shop").on("click",function(e){e.preventDefault(),v("#the-shop")}),$(".footer-stats").on("click",function(e){e.preventDefault(),v("#stats")}),$("#back-to-shop").on("click",function(e){e.preventDefault(),v("#the-shop")}),$(".item-slot").on("click",function(e){e.preventDefault(),v("#the-shop-helmet")}),$("#leave-race-results").on("click",function(e){e.preventDefault(),$("#audio-mus-victory").remove(),v("#run"),$("#today-run").hide(),$("#next-run").show(),$("#race-day").hide()})});